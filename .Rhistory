group_by(RACE_CODE_CD) %>%
count_pct(RACE_CODE_CD) %>%
arrange(desc(n))
distinct_df_accused %>%
group_by(RACE_CODE_CD) %>%
count(RACE_CODE_CD) %>%
arrange(desc(n))
distinct_df_accused %>%
group_by(RACE_CODE_CD) %>%
count_pct
distinct_df_accused %>%
group_by(RACE_CODE_CD) %>%
count_pct %>%
arrange(desc(n))
distinct_df_accused %>%
group_by(RACE_CODE_CD, SEX_CODE_CD) %>%
count_pct %>%
arrange(desc(n))
distinct_df_accused %>%
group_by(SEX_CODE_CD) %>%
count_pct %>%
arrange(desc(n))
distinct_df_accused %>%
group_by(SEX_CODE_CD, RACE_CODE_CD) %>%
count_pct %>%
arrange(desc(n))
View(count_pct)
distinct_df_accused %>%
group_by(SEX_CODE_CD, RACE_CODE_CD) %>%
count_pct %>%
arrange(desc(n))
distinct_df_accused %>%
group_by(RACE_CODE_CD) %>%
count_pct %>%
arrange(desc(n))
distinct_df_accused %>%
group_by(RACE_CODE_CD) %>%
count_pct %>%
arrange(desc(n))
distinct_df_accused %>%
group_by(SEX_CODE_CD, RACE_CODE_CD) %>%
count_pct %>%
arrange(desc(n))
distinct_df_accused %>%
group_by(RACE_CODE_CD,SEX_CODE_CD) %>%
count_pct %>%
arrange(desc(n))
distinct_df_accused %>%
group_by(RACE_CODE_CD) %>%
count_pct %>%
arrange(desc(n))
distinct_df_accused %>%
group_by(SEX_CODE_CD) %>%
count_pct %>%
arrange(desc(n))
distinct_df_accused %>%
group_by(ALLEGATION_CATEGORY) %>%
count_pct %>%
arrange(desc(n))
distinct_df_accused %>%
group_by(ALLEGATION_CATEGORY) %>%
count_pct %>%
arrange(desc(n))
distinct_df_accused %>%
group_by(ALLEGATION_CATEGORY) %>%
count(ALLEGATION_CATEGORY) %>%
arrange(desc(n))
distinct_df_accused %>%
group_by(ALLEGATION_CATEGORY) %>%
count_pct %>%
arrange(desc(n))
distinct_df_accused %>%
group_by(ALLEGATION_CATEGORY) %>%
count(ALLEGATION_CATEGORY) %>%
arrange(desc(n))
excessive_force_df %>%
group_by(NEW_ALLEGATION_CATEGORY) %>%
count_pct %>%
arrange(desc(n))
ggplot(excessive_force_df) +
aes(
x = NEW_ALLEGATION_CATEGORY,
fill = NEW_ALLEGATION_CATEGORY
) +
geom_bar(aes(y =(..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
scale_fill_brewer(palette = "Set1", direction = 1) +
labs(
x = "Allegations",
y = "Total %",
title = "Allegation Segmentation",
subtitle = "Excessive Use of Force"
) +
theme_gray() +
theme(legend.position = "bottom")
distinct_df_accused %>%
group_by(FINDING_CODE) %>%
count(FINDING_CODE) %>%
arrange(desc(n))
distinct_df_accused %>%
group_by(FINDING_CODE) %>%
count_pct %>%
arrange(desc(n))
findings_df <-  mutate(excessive_force_df, NEW_FINDINGS_CATEGORY =
ifelse(grepl("NA", FINDING_CODE), "NOT_SUSTAINED",
ifelse(grepl("UNFOUNDED", FINDING_CODE), "NOT_SUSTAINED",
ifelse(grepl("NOT SUSTAINED", FINDING_CODE), "NOT_SUSTAINED",
ifelse(grepl("NO AFFIDAVIT", FINDING_CODE), "NOT_SUSTAINED",
ifelse(grepl("ADDITIONAL", FINDING_CODE), "NOT_SUSTAINED",
ifelse(grepl("EXONERATED", FINDING_CODE), "NOT_SUSTAINED",
"SUSTAINED"
)))))))
distinct_df_accused %>%
filter(!(FINDING_CODE %in% "ADDITIONAL INVESTIGATION REQUESTED") & !is.na(FINDING_CODE)) %>%
ggplot() +
aes(x = FINDING_CODE, fill = FINDING_CODE) +
geom_bar(aes(y =(..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
scale_fill_manual(values = list(
'EXONERATED' = "#CFE1F2", `NO AFFIDAVIT` = "#93C4DE",
`NOT SUSTAINED` = "#4A97C9", SUSTAINED = "#AB2E16", UNFOUNDED = "#CFE1F2")) +
labs(
x = "Case Findings",
y = "Total %",
title = "Case Findings for All Allegations"
) +
theme_gray() +
theme(legend.position = "bottom")
findings_df %>%
group_by(NEW_ALLEGATION_CATEGORY) %>%
count(NEW_FINDINGS_CATEGORY) %>%
arrange(desc(n))
findings_df %>%
group_by(NEW_ALLEGATION_CATEGORY) %>%
count_pct %>%
arrange(desc(n))
findings_df %>%
group_by(NEW_FINDINGS_CATEGORY) %>%
count_pct %>%
arrange(desc(n))
findings_df %>%
group_by(NEW_FINDINGS_CATEGORY) %>%
count_pct %>%
arrange(desc(n))
findings_df %>%
filter(!(FINDING_CODE %in% "ADDITIONAL INVESTIGATION REQUESTED") & !is.na(FINDING_CODE)) %>%
ggplot() +
aes(x = NEW_FINDINGS_CATEGORY, fill = FINDING_CODE) +
geom_bar(aes(y =(..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
scale_fill_manual(values = list(
`ADDITIONAL INVESTIGATION REQUESTED` = "#F7FBFF", EXONERATED = "#CFE1F2", `NO AFFIDAVIT` = "#93C4DE",
`NOT SUSTAINED` = "#4A97C9", SUSTAINED = "#AB2E16", UNFOUNDED = "#08306B")) +
labs(x = "Case Findings",
y = "Total", title = "Case Outcomes for All Allegations") +
theme_gray() +
theme(legend.position = "bottom")
penalty_id_pk %>%
group_by(PENALTY_CODE) %>%
count(PENALTY_CODE) %>%
arrange(desc(n))
penalty_id_pk %>%
group_by(PENALTY_CODE) %>%
count_pct %>%
arrange(desc(n))
excessive_force_df %>%
filter(!(PENALTY_CODE %in% "WORK REGULAR DAY OFF") & !is.na(PENALTY_CODE)) %>%
ggplot() +
aes(x = PENALTY_CODE) +
geom_bar(fill = "#B22222",aes(y =(..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
labs(
x = "Penalties",
y = "Total Number",
title = "Comparative Penalty Analysis",
subtitle = " Analyzing the penalties for the Use of Excessive Force"
) +
coord_flip() +
theme_minimal() +
facet_wrap(vars(NEW_ALLEGATION_CATEGORY))
esquisser(distinct_df_accused)
ggplot(df, aes(monthweek, weekdayf, fill = VIX.Close)) +
geom_tile(colour = "white") +
facet_grid(year~monthf) +
scale_fill_gradient(low="red", high="green") +
labs(x="Week of Month",
y="",
title = "Time-Series Calendar Heatmap",
subtitle="Yahoo Closing Price",
fill="Close")
View(df_case_info)
ggplot(df_case_info, aes(monthweek, weekdayf, fill = VIX.Close)) +
geom_tile(colour = "white") +
facet_grid(year~monthf) +
scale_fill_gradient(low="red", high="green") +
labs(x="Week of Month",
y="",
title = "Time-Series Calendar Heatmap",
subtitle="Yahoo Closing Price",
fill="Close")
distinct_df_accused(ALLEGATION_CODE_CD)
distinct_df_accused %>% count(ALLEGATION_CODE_CD)
View(distinct_df_accused)
distinct_df_accused %>% count(ALLEGATION_CATEGORY)
distinct_df_accused %>% sum(ALLEGATION_CATEGORY)
distinct_df_accused %>% sum(ALLEGATION_CATEGORY)
distinct_df_accused %>% n(row)
(distinct_df_accused, ALLEGATION_CATEGORY)
count(distinct_df_accused)
204641 +75320 =
204641 +75320
distinct_df_accused %>% count(distinct(ALLEGATION_CATEGORY))
ncol(distinct_df_accused$ALLEGATION_CATEGORY)
ncol(distinct_df_accused$ALLEGATION_CATEGORY)
ncol(distinct_df_accused$ALLEGATION_CATEGORY)
distinct(distinct_df_accused$ALLEGATION_CATEGORY)
distinct(ALLEGATION_CATEGORY)
distinct_df_accused %>% distinct(ALLEGATION_CATEGORY)
![](ER_Model_updated.png)
![](accused_dashboard.png)
View(distinct_df_accused)
View(excessive_force_df)
View(findings_df)
View(df_case_info)
left_join_df <- left_join(findings_df,df_case_info, by = "LOG_NO")
left_join(findings_df,df_case_info, by = "LOG_NO")
# Example
x <- "findings_df"
typeof(LOG_NO)
# Example
x <- "findings_df"
typeof("LOG_NO")
# Example
x <- "df_case_info"
typeof("LOG_NO")
findings_df$LOG_NO <- as.integer(findings_df$LOG_NO)
# Example
x <- "findings_df"
typeof("LOG_NO")
findings_df$LOG_NO <- as.integer(findings_df$LOG_NO)
# Example
x <- "findings_df"
typeof("LOG_NO")
df_case_info$LOG_NO <- as.integer(df_case_info$LOG_NO)
# Example
x <- "df_case_info"
typeof("LOG_NO")
# Example
x <- "findings_df"
typeof("LOG_NO")
# Example
x <- "df_case_info"
typeof("LOG_NO")
left_join(findings_df,df_case_info, by = c("LOG_NO"))
left_join_df <- left_join(findings_df,df_case_info, by = c("LOG_NO"))
esquisser(left_join_df)
left_join_df %>%
filter(!(FINDING_CODE %in% "ADDITIONAL INVESTIGATION REQUESTED") & !is.na(FINDING_CODE)) %>%
filter(!(PENALTY_CODE %in% "WORK REGULAR DAY OFF") | is.na(PENALTY_CODE)) %>%
ggplot() +
aes(x = FINDING_CODE, fill = NEW_FINDINGS_CATEGORY) +
geom_bar() +
scale_fill_hue(direction = 1) +
labs(x = "Case Outcome", y = "Total %") +
coord_flip() +
theme_gray() +
theme(legend.position = "bottom") +
facet_wrap(
vars(COMPLAINANT_TYPE),
scales = "free",
ncol = 6L,
nrow = 6L
)
left_join_df %>%
filter(!(FINDING_CODE %in% "ADDITIONAL INVESTIGATION REQUESTED") & !is.na(FINDING_CODE)) %>%
filter(!(PENALTY_CODE %in% "WORK REGULAR DAY OFF") | is.na(PENALTY_CODE)) %>%
ggplot() +
aes(x = FINDING_CODE, fill = NEW_FINDINGS_CATEGORY) +
geom_bar(aes(y =(..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
labs(x = "Case Outcome", y = "Total %") +
coord_flip() +
theme_gray() +
theme(legend.position = "bottom") +
facet_wrap(
vars(COMPLAINANT_TYPE),
scales = "free",
ncol = 6L,
nrow = 6L
)
View(left_join_df)
left_join_df %>%
group_by(NEW_FINDINGS_CATEGORY) %>%
count_pct %>%
arrange(desc(n))
left_join_df %>%
group_by(NEW_FINDINGS_CATEGORY, COMPLAINANT_TYPE) %>%
count_pct %>%
arrange(desc(n))
left_join_df %>%
group_by(COMPLAINANT_TYPE) %>%
count_pct %>%
arrange(desc(n))
left_join_df %>%
group_by(COMPLAINANT_TYPE, FINDING_CODE) %>%
count_pct %>%
arrange(desc(n))
left_join_df %>%
group_by(COMPLAINANT_TYPE) %>%
count_pct %>%
arrange(desc(n))
left_join_df %>%
group_by(COMPLAINANT_TYPE == "CIVILIAN") %>%
count_pct %>%
arrange(desc(n))
left_join_df %>%
group_by(COMPLAINANT_TYPE) %>%
count_pct %>%
arrange(desc(n))
left_join_df %>%
filter("CIVILIAN")
left_join_df %>%
filter(COMPLAINANT_TYPE)
left_join_df %>%
filter(COMPLAINANT_TYPE == CIVILIAN)
left_join_df %>%
filter(COMPLAINANT_TYPE == CIVILIAN)
left_join_df %>%
filter(COMPLAINANT_TYPE)
left_join_df %>%
filter(COMPLAINANT_TYPE)
left_join_df %>%
filter(FINDING_CODE)
left_join_df %>%
filter(FINDING_CODE ="SUSTAINED")
left_join_df %>%
filter(FINDING_CODE == "SUSTAINED")
group_by(COMPLAINANT_TYPE)
left_join_df %>%
group_by(COMPLAINANT_TYPE) %>%
count_pct %>%
arrange(desc(n))
left_join_df %>%
filter(FINDING_CODE == "SUSTAINED")
group_by(COMPLAINANT_TYPE)
left_join_df %>%
filter(FINDING_CODE == "SUSTAINED")
group_by(count(COMPLAINANT_TYPE))
left_join_df %>%
filter(FINDING_CODE == "SUSTAINED")
group_by(distinct(COMPLAINANT_TYPE))
left_join_df %>%
filter(FINDING_CODE == "SUSTAINED")
group_by(COMPLAINANT_TYPE)
install.packages("rpivotTable")
library(tidyverse)
library(janitor)
library(skimr)
library(RMySQL)
library(keyring)
library(odbc)
library(readxl)
library(RSQLite)
library(dbplyr)
library(dplyr)
library(ggplot2)
library(esquisse)
library(modeldata)
library(sqldf)
library(RColorBrewer)
library(reshape2)
install.packages("reshape2")
library(tidyverse)
library(janitor)
library(skimr)
library(RMySQL)
library(keyring)
library(odbc)
library(readxl)
library(RSQLite)
library(dbplyr)
library(dplyr)
library(ggplot2)
library(esquisse)
library(modeldata)
library(sqldf)
library(RColorBrewer)
library(reshape2)
library(rpivotTable)
rpivotTable(left_join_df)
View(pivot)
pivot <- left_join_df %>% select(COMPLAINANT_TYPE, FINDING_CODE,PENALTY_CODE)
View(pivot)
pivot <- left_join_df %>% select(COMPLAINANT_TYPE, FINDING_CODE,PENALTY_CODE)
head(pivot)
pivot <- left_join_df %>% select(COMPLAINANT_TYPE, FINDING_CODE,PENALTY_CODE)
group_by(COMPLAINANT_TYPE, FINDING_CODE)
pivot <- left_join_df %>% select(COMPLAINANT_TYPE, FINDING_CODE,PENALTY_CODE)
group_by(PENALTY_CODE, FINDING_CODE)
pivot %>%
group_by(COMPLAINANT_TYPE,FINDING_CODE,PENALTY_CODE) %>%
count_pct %>%
arrange(desc(n))
pivot %>%
group_by(COMPLAINANT_TYPE,FINDING_CODE) %>%
count_pct %>%
arrange(desc(n))
pivot %>%
group_by(FINDING_CODE) %>%
count_pct %>%
arrange(desc(n))
pivot %>%
group_by(FINDING_CODE) %>%
count_pct %>%
arrange(desc(n_pct))
left_join_df <- left_join(findings_df,df_case_info, by = c("LOG_NO"))
left_join_df %>%
group_by(COMPLAINANT_TYPE) %>%
count_pct %>%
arrange(desc(n))
left_join_df <- left_join(findings_df,df_case_info, by = c("LOG_NO"))
View(left_join_df)
left_join_df <- inner_join(findings_df,df_case_info, by = c("LOG_NO"))
left_join_df <- inner_join(findings_df,df_case_info, by = c("LOG_NO"))
left_join_df <- right_join(findings_df,df_case_info, by = c("LOG_NO"))
left_join_df <- join_query(findings_df,df_case_info, by = c("LOG_NO"))
left_join_df <- join(findings_df,df_case_info, by = c("LOG_NO"))
left_join_df <- semi_join(findings_df,df_case_info, by = c("LOG_NO"))
semi_join_df <- semi_join(findings_df,df_case_info, by = c("LOG_NO"))
semi_join_df %>%
group_by(COMPLAINANT_TYPE) %>%
count_pct %>%
arrange(desc(n))
View(semi_join_df)
left_join_df <- semi_join(findings_df,df_case_info, by = c("LOG_NO"))
left_join_df %>%
group_by(COMPLAINANT_TYPE) %>%
count_pct %>%
arrange(desc(n))
left_join_df %>%
group_by(COMPLAINANT_TYPE) %>%
count_pct %>%
arrange(desc(n))
left_join_df %>%
group_by(COMPLAINANT_TYPE) %>%
count_pct %>%
arrange(desc(n))
View(left_join_df)
left_join_df <- semi_join(findings_df,df_case_info, by = c("LOG_NO"))
left_join_df <- semi_join(findings_df,df_case_info, by = c("LOG_NO"))
View(left_join_df)
pivot <- left_join_df %>% select(COMPLAINANT_TYPE, FINDING_CODE,PENALTY_CODE)
pivot %>%
group_by(FINDING_CODE) %>%
count_pct %>%
arrange(desc(n_pct))
left_join_df %>%
filter(!(FINDING_CODE %in% "ADDITIONAL INVESTIGATION REQUESTED") & !is.na(FINDING_CODE)) %>%
filter(!(PENALTY_CODE %in% "WORK REGULAR DAY OFF") | is.na(PENALTY_CODE)) %>%
ggplot() +
aes(x = FINDING_CODE, fill = NEW_FINDINGS_CATEGORY) +
geom_bar(aes(y =(..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
labs(x = "Case Outcome", y = "Total %") +
coord_flip() +
theme_gray() +
theme(legend.position = "bottom") +
facet_wrap(
vars(COMPLAINANT_TYPE),
scales = "free",
ncol = 6L,
nrow = 6L
)
View(finding_code_3nf)
View(findings_df)
left_join_df <- left_join(findings_df,df_case_info, by="LOG_NO")
left_join_df %>%
filter(!(FINDING_CODE %in% "ADDITIONAL INVESTIGATION REQUESTED") & !is.na(FINDING_CODE)) %>%
filter(!(PENALTY_CODE %in% "WORK REGULAR DAY OFF") | is.na(PENALTY_CODE)) %>%
ggplot() +
aes(x = FINDING_CODE, fill = NEW_FINDINGS_CATEGORY) +
geom_bar(aes(y =(..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
labs(x = "Case Outcome", y = "Total %") +
coord_flip() +
theme_gray() +
theme(legend.position = "bottom") +
facet_wrap(
vars(COMPLAINANT_TYPE),
scales = "free",
ncol = 6L,
nrow = 6L
)
penalty_id_pk %>%
group_by(PENALTY_CODE) %>%
count_pct %>%
arrange(desc(n))
excessive_force_df %>%
filter(!(PENALTY_CODE %in% "WORK REGULAR DAY OFF") & !is.na(PENALTY_CODE)) %>%
ggplot() +
aes(x = PENALTY_CODE) +
geom_bar(fill = "#B22222",aes(y =(..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
labs(
x = "Penalties",
y = "Total Number",
title = "Comparative Penalty Analysis",
subtitle = " Analyzing the penalties for the Use of Excessive Force"
) +
coord_flip() +
theme_minimal() +
facet_wrap(vars(NEW_ALLEGATION_CATEGORY))
