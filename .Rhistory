knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(skimr)
library(RMySQL)
library(keyring)
library(odbc)
df_accused <- read_xlsx("FinalProject/accused")
df_accused <- read_xl("FinalProject/accused")
library(tidyverse)
library(janitor)
library(skimr)
library(RMySQL)
library(keyring)
library(odbc)
library("readxl")
df_accused <- read_excel("accused.xlsx")
View(df_accused)
df_case_info <- read_excel("case_info.xlsx")
View(df_case_info)
df_civilian_witness <- read_excel("civilian_witness.xlsx")
df_complainant <- read_excel("complainant.xlsx")
df_cpd_witness <- read_excel("cpd_witness.xlsx")
df_investigators <- read_excel("investigators.xlsx")
df_victim <- read_excel("victim.xlsx")
df_victim <- read_excel("victim.xlsx")
library(tidyverse)
library(janitor)
library(skimr)
library(RMySQL)
library(keyring)
library(odbc)
library("readxl")
library(RSQLite)
View(df_accused)
dbGetQuery(df_accused, 'SELECT * FROM accused LIMIT 5')
View(df_accused)
View(df_accused)
df_accused.PrimaryKey <- [| df_accused.Columns.["LOG_NO"] |]
df_accused %>%
count(LOG_NO) %>%
filter(n > 1)
df_accused %>%
count(LOG_NO)
View(df_accused)
df_accused %>%
count(LOG_NO)
filter desc
df_accused %>%
count(LOG_NO)
filter (desc)
df_accused %>%
count(LOG_NO) %>%
filter (desc)
df_accused %>%
count(LOG_NO)
filter
df_accused %>%
desc(count(LOG_NO))
df_accused_clean <- df_accused %>%
filter_all(any_vars(. == "N/A" | . == "Unspecified"))
View(df_accused_clean)
View(df_accused)
columns_missing_most_data <- df_accused %>%
summarise(across(everything(), ~ skimr::n_missing(.x))) %>%
pivot_longer(cols = everything(),
names_to = "variable",
values_to = "missing_count") %>%
mutate(proportion_missing = round(missing_count / nrow(df_sandy_clean), 2)) %>%
arrange(desc(missing_count)) %>%
# Detect columns that were missing more than 50% of the data
filter(proportion_missing > .5) %>%
pull(variable)
columns_missing_most_data <- df_accused %>%
summarise(across(everything(), ~ skimr::n_missing(.x))) %>%
pivot_longer(cols = everything(),
names_to = "variable",
values_to = "missing_count") %>%
mutate(proportion_missing = round(missing_count / nrow(df_accused), 2)) %>%
arrange(desc(missing_count)) %>%
# Detect columns that were missing more than 50% of the data
filter(proportion_missing > .5) %>%
pull(variable)
print(message("Columns missing 50%+ data:"))
columns_missing_most_data
View(df_accused)
select (count(df_accused))
select (df_accused, penalty_code)
select (df_accused, PENALTY_CODE)
select (df_accused, PENALTY_CODE)
filter("NA")
select (df_accused, PENALTY_CODE)
filter(NA)
df_accused %>%
filter_all((! is.na(.)PENALTY_CODE))
df_accused %>%
filter_all((is.na(.)PENALTY_CODE))
df_accused %>%
filter(! is.na(PENALTY_CODE)
df_accused %>%
filter(! is.na(PENALTY_CODE))
279,961/85,873
279961/85873
85873/279961= *100
85873/279961 * 100
df_accused %>%
filter(PENALTY_CODE))
df_accused %>%
filter(PENALTY_CODE)
df_accused %>%
PENALTY_CODE
df_accused %>% PENALTY_CODE
select (df_accused, PENALTY_CODE)
df_accused %>%
filter(! is.na(PENALTY_CODE))
select (df_accused, PENALTY_CODE)
filter(SUSPENSION)
select (df_accused, PENALTY_CODE)
filter("SUSPENSION")
df_accused %>%
filter(PENALTY_CODE="SUSPENSION")
df_accused %>%
filter (PENALTY_CODE="SUSPENSION")
df_accused %>%
filter (PENALTY_CODE == "SUSPENSION")
df_accused %>%
filter (PENALTY_CODE == "REPRIMAND")
length(unique(df_accused$id))
length(unique(df_accused$LOG_NO))
df_accused %>%
filter (PENALTY_CODE == "VIOLATION NOTED")
df_accused %>%
filter (PENALTY_CODE == "SEPARATION")
length(unique(df_accused$EMPLOYEE_NO))
View(df_accused)
count(df_accused, EMPLOYEE_NO)
df_accused %>% count(EMPLOYEE_NO)
View(df_accused)
View(df_accused)
df_accused %>%
count(LOG_NO)
df_accused %>%
count(LOG_NO)
View(df_accused)
View(df_accused)
df_accused %>%
count(LOG_NO)
sort(desc())
df_accused %>%
count(LOG_NO)
df_accused %>%
count(LOG_NO) %>%
order(n)
df_accused %>%
count(LOG_NO) %>%
order(LOG_NO)
df_accused %>%
count(LOG_NO) %>%
order(-LOG_NO)
df_accused %>%
count(LOG_NO) %>%
order(LOG_NO,)
df_accused %>%
count(LOG_NO)
df_accused %>%
count(LOG_NO) %>%
[order(LOG_NO)]
df_accused %>%
count(LOG_NO) %>%
order(LOG_NO)
df_accused %>%
count(LOG_NO) %>%
order(df_accused$LOG_NO)
df_accused %>%
count(LOG_NO) %>%
desc(LOG_NO)
df_accused %>%
count(LOG_NO) %>%
arrange(LOG_NO)
df_accused %>%
count(LOG_NO) %>%
arrange(count(LOG_NO))
df_accused %>%
arrange(count(LOG_NO))
df_accused %>%
arrange count(LOG_NO)
df_accused %>%
arrange %>% count(LOG_NO)
df_accused %>%
arrange %>% -count(LOG_NO)
df_accused %>%
arrange %>% count(LOG_NO)
df_log_arrange <- log_arrange %>%
count(LOG_NO)
df_log_arrange <- df_accused %>%
count(LOG_NO)
df_log_arrange %>%
arrange(LOG_NO)
View(df_accused)
df_log_arrange <- df_accused %>%
count(LOG_NO)
df_log_arrange %>%
arrange(LOG_NO)
df_accused %>% count(LOG_NO)
df_accused %>% count(LOG_NO)
distinct_df_accused <- distinct(df_accused)
View(distinct_df_accused)
df_penalty_id <- distinct_df_accused %>%
select(PENALTY_ID,LOG_NO)
View(df_penalty_id)
df_penalty_id <- distinct_df_accused %>%
select(PENALTY_ID,PENALTY_CODE, LOG_NO)
View(df_penalty_id)
length(unique(df_accused$EMPLOYEE_NO))
duplicated(df_accused)
View(df_accused)
duplicated(df_accused)
View(df_accused)
duplicated(df_accused)
distinct(df_accused)
distinct(df_accused, LOG_NO)
View(distinct_df_accused)
View(df_accused)
count(distinct_df_accused, LOG_NO)
count(df_accused, LOG_NO)
df_ln_removed <- distinct_df_accused [, -5]
View(df_cpd_witness)
View(df_ln_removed)
df_ln_removed <- distinct_df_accused [, -1]
View(df_ln_removed)
key(df_accused)
ValidatePrimKey(df_accused), prim.key)
ValidatePrimKey(df_accused) prim.key)
ValidatePrimKey(df_accused)
View(df_ln_removed)
df_no_penaltyID <- df_ln_removed %>%
subset(select= -PENALTY_ID)
View(df_no_penaltyID)
distinct_clean_df <- distinct(df_accused)
View(distinct_clean_df)
distinct_clean_df <- distinct(df_no_penaltyID)
View(distinct_clean_df)
View(distinct_clean_df)
View(distinct_clean_df)
View(distinct_clean_df)
View(df_no_penaltyID)
View(df_penalty_id)
View(distinct_df_accused)
distinct(df_accused, LOG_NO)
distinct(distinct_df_accused, PENALTY_ID)
count(distinct_df_accused, PENALTY_ID)
count(distinct_df_accused, PENALTY_ID)
View(distinct_df_accused)
View(df_accused)
distinct(distinct_df_accused, PENALTY_ID)
count(distinct_df_accused, PENALTY_ID)
count(distinct_df_accused, STAR_NO)
distinct(df_accused, LOG_NO)
View(distinct_df_accused)
View(distinct_df_accused)
distinct_df_accused <- distinct_df_accused %>% subset(select= -ALLEGATION_CATEGORY_CD)
View(distinct_df_accused)
distinct_df_accused <- distinct(df_accused)
distinct_df_accused <- distinct(df_accused)
distinct(distinct_df_accused,LOG_NO)
count(distinct_df_accused, PENALTY_ID)
count(distinct_df_accused, STAR_NO)
View(distinct_df_accused)
distinct_df_accused <- distinct_df_accused %>% subset(select= -ALLEGATION_CATEGORY_CD)
View(distinct_df_accused)
count(distinct_df_accused, STAR_NO)
View(distinct_df_accused)
count(distinct_df_accused, ALLEGATION_CATEGORY)
count(distinct_df_accused, ALLEGATION_CATEGORY) %>% arrange(desc(n))
count(distinct_df_accused, ALLEGATION_CATEGORY) %>% arrange(desc(n))
distinct_df_accused %>%
filter(! is.na(PENALTY_CODE))
select (distinct_df_accused, PENALTY_CODE)
49221/225523 * 100
count(distinct_df_accused, PENALTY_CODE) %>% arrange(desc(n))
count(distinct_df_accused, ALLEGATION_CATEGORY) %>% arrange(desc(n))
count(distinct_df_accused, ALLEGATION_CATEGORY) %>% arrange(desc(n))
distinct_df_accused <- distinct(df_accused)
library(tidyverse)
library(janitor)
library(skimr)
library(RMySQL)
library(keyring)
library(odbc)
library("readxl")
library(RSQLite)
distinct_df_accused <- distinct(df_accused)
distinct_df_accused <- distinct(df_accused)
distinct(distinct_df_accused,LOG_NO)
distinct(df_accused, LOG_NO)
count(distinct_df_accused, PENALTY_ID)
count(distinct_df_accused, STAR_NO)
df_penalty_id <- distinct_df_accused %>%
select(PENALTY_ID,PENALTY_CODE, LOG_NO)
columns_missing_most_data <- df_accused %>%
summarise(across(everything(), ~ skimr::n_missing(.x))) %>%
pivot_longer(cols = everything(),
names_to = "variable",
values_to = "missing_count") %>%
mutate(proportion_missing = round(missing_count / nrow(df_accused), 2)) %>%
arrange(desc(missing_count)) %>%
# Detect columns that were missing more than 50% of the data
filter(proportion_missing > .5) %>%
pull(variable)
print(message("Columns missing 50%+ data:"))
columns_missing_most_data
select (distinct_df_accused, PENALTY_CODE)
distinct_df_accused %>%
filter(! is.na(PENALTY_CODE))
49221/225523 * 100
count(distinct_df_accused, PENALTY_CODE) %>% arrange(desc(n))
df_accused %>%
filter (PENALTY_CODE == "SUSPENSION")
write.csv(distinct_df_accused, "accused_semi_cleaned.csv")
count(distinct_df_accused, LOG_NO) %>% arrange(desc(n))
distinct_df_accused <- distinct(df_accused)
count(distinct_df_accused, LOG_NO) %>% arrange(desc(n))
distinct(df_accused, LOG_NO)
count(distinct_df_accused, PENALTY_ID)
count(distinct_df_accused, PENALTY_ID) %>% arrange(desc(n))
count(distinct_df_accused, STAR_NO) %>% arrange(desc(n))
columns_missing_most_data <- df_accused %>%
summarise(across(everything(), ~ skimr::n_missing(.x))) %>%
pivot_longer(cols = everything(),
names_to = "variable",
values_to = "missing_count") %>%
mutate(proportion_missing = round(missing_count / nrow(df_accused), 2)) %>%
arrange(desc(missing_count)) %>%
# Detect columns that were missing more than 50% of the data
filter(proportion_missing > .5) %>%
pull(variable)
print(message("Columns missing 50%+ data:"))
columns_missing_most_data
select (distinct_df_accused, PENALTY_CODE)
distinct_df_accused %>%
filter(! is.na(PENALTY_CODE))
count(distinct_df_accused, PENALTY_CODE) %>% arrange(desc(n))
count(distinct_df_accused, EMPLOYEE_POSITION) %>% arrange(desc(n))
count(distinct_df_accused, ALLEGATION_CATEGORY) %>% arrange(desc(n))
count(distinct_df_accused, ACCUSSED_ARRESTED) %>% arrange(desc(n))
count(distinct_df_accused, ACCUSED_ARRESTED) %>% arrange(desc(n))
count(distinct_df_accused, ACCUSED_ARRESTED)
count(distinct_df_accused, ACCUSED_ARRESTED)
sum(distinct_df_accused, ACCUSED_ARRESTED)
count(distinct_df_accused, ACCUSED_ARRESTED)
3453/187011 +34705+354
187011 +34705+354
3453/222070 * 100
222070/3453 * 100
3453/222070 * 100
count(distinct_df_accused, FINDING_CODE)
count(distinct_df_accused, FINDING_CODE) %>% arrange(desc(n))
count(distinct_df_accused, NARRATIVE) %>% arrange(desc(n))
View(distinct_df_accused)
count(distinct_df_accused, LOG_NO) %>% arrange(desc(n))
View(df_penalty_id)
View(distinct_df_accused)
distinct_df_accused %>%
janitor::clean_names()
distinct_df_accused <- distinct(df_accused)
distinct_df_accused %>%
janitor::clean_names()
count(distinct_df_accused, LOG_NO) %>% arrange(desc(n))
count(distinct_df_accused, RACE_CODE) %>% arrange(desc(n))
View(distinct_df_accused)
count(distinct_df_accused, RACE_CODE_CD) %>% arrange(desc(n))
count(distinct_df_accused, SEX_CODE_CD) %>% arrange(desc(n))
count(distinct_df_accused, PENALTY_CODE) %>% arrange(desc(n))
count(distinct_df_accused, ALLEGATION_CODE) %>% arrange(desc(n))
count(distinct_df_accused, ALLEGATION_CATEGORY_CD) %>% arrange(desc(n))
count(distinct_df_accused, ALLEGATION_CATEGORY, ALLEGATION_CATEGORY_CD) %>% arrange(desc(n))
View(df_case_info)
View(df_cpd_witness)
knitr::opts_chunk$set(echo = TRUE)
install_version("dbplyr", version = "1.4.2")
remotes::install_version("dbplyr", version = "1.4.2")
library(tidyverse)
summary(df_accused)
summary(df_case_info)
library(tidyverse)
library(janitor)
library(skimr)
library(RMySQL)
library(keyring)
library(odbc)
library(readxl)
library(RSQLite)
library(dbplyr)
library(dplyr)
library(tidyverse)
library(janitor)
library(skimr)
library(RMySQL)
library(keyring)
library(odbc)
library(readxl)
library(RSQLite)
library(dbplyr)
library(esquisse)
install.packages(esquisse)
install.packages("esquisse"")
install.packages("esquisse")
install.packages("esquisse")
esquisse(esquisser)
esquisse::esquisser
esquisser(distinct_df_accused)
esquisse(distinct_df_accused)
library(esquisse)
esquisse(esquisser)
esquisse(distinct_df_accused)
esquisser(distinct_df_accused)
count(distinct_df_accused, PENALTY_CODE) %>% arrange(desc(n))
count(distinct_df_accused, ACCUSED_ARRESTED) %>% arrange(desc(n))
distinct_df_accused %>%
filter(!(PENALTY_CODE %in% "WORK REGULAR DAY OFF") | is.na(PENALTY_CODE)) %>%
ggplot() +
aes(x = PENALTY_CODE, fill = PENALTY_CODE) +
geom_bar() +
scale_fill_hue(direction = -1) +
labs(
x = "Penalty Type",
y = "Total Penalties",
title = "Penalty Report"
) +
theme_bw() +
theme(legend.position = "bottom")
library(tidyverse)
library(janitor)
library(skimr)
library(RMySQL)
library(keyring)
library(odbc)
library(readxl)
library(RSQLite)
library(dbplyr)
library(dplyr)
library(tidyverse)
library(janitor)
library(skimr)
library(RMySQL)
library(keyring)
library(odbc)
library(readxl)
library(RSQLite)
library(dbplyr)
library(dplyr)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(janitor)
library(skimr)
library(RMySQL)
library(keyring)
library(odbc)
library(readxl)
library(RSQLite)
library(dbplyr)
library(dplyr)
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
